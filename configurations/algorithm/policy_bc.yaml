policy:
  type: resnet_temporal_factorized   # formerly vpt_causal

  # ---- vision backbone ----
  backbone: resnet50
  pretrained_backbone: true
  backbone_trainable: true
  backbone_dim: null                # null → use encoder’s native dim

  # ---- temporal encoder (causal Transformer) ----
  # temporal_layers: 2
  # temporal_heads: 4
  # temporal_dropout: 0.0
  # attention_mask: causal            # causal self-attn over T
  # mem_len: 0                        # 0 = no TXL-style memory (use >0 only if you add TXL)

  # ---- head/trunk MLP (shared) ----
  hidden_dim: 512
  head_layers: 2
  dropout: 0.0
  activation: gelu

  # ---- VPT-style factorized action head ----
  action:
    buttons_classes: 80          # legacy shim (value unused)
    camera_bins: 11              # must match dataset/action mapper bins
    temperature: 1.0             # softmax temperature fed into VPT head
    use_camera_gate: false       # retained for legacy compatibility (ignored)

  # ---- loss knobs (for training code to read) ----
  loss:
    label_smoothing: 0.05        # for CE heads (buttons/cam_x/cam_y)
    gate_weight: 0.5             # weight for camera gate CE
    esc_weight: 1.0              # weight for ESC classifier CE
    entropy_weight: 0.01         # buttons/camera entropy bonus
    # (optional) class weights/focal for buttons if long-tail:
    # buttons_focal_gamma: 1.0
    # buttons_class_weights: ${dataset.buttons_class_weights}

  # ---- optional auxiliary joint token head (start disabled) ----
  joint_head:
    enabled: false
    vocab_size: null              # set explicitly if you enable joint token supervision
    loss_weight: 0.3
